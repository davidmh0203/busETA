<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ì…”í‹€ë²„ìŠ¤ ì •ë³´ - BusETA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/static/css/bootstrap.min.css" />
</head>
<body>
  <div class="container mt-5">
    <h2 class="text-center mb-4">ğŸšŒ ì…”í‹€ë²„ìŠ¤ ì •ë³´</h2>

    <!-- ì‹œê°„ ê¸°ì¤€ ì•ˆë‚´ -->
    <div class="alert alert-secondary text-center" role="alert">
      í˜„ì¬ ì‹œê°„: <strong id="current-time"></strong><br />
      ê°€ì¥ ê°€ê¹Œìš´ ì…”í‹€ì„ ì¶”ì²œí•©ë‹ˆë‹¤.
    </div>

    <!-- ì…”í‹€ ì •ë³´ í…Œì´ë¸” -->
    <table class="table table-striped">
      <thead class="table-dark">
        <tr>
          <th>ë°©í–¥</th>
          <th>ì¶œë°œ ì‹œê°</th>
          <th>ì¶œë°œê¹Œì§€ ë‚¨ì€ ì‹œê°„</th>
          <th>ë¹„ê³ </th>
        </tr>
      </thead>
      <tbody id="shuttle-table-body">
        <!-- JavaScriptë¡œ ë™ì  ì‚½ì… -->
      </tbody>
    </table>

    <!-- ì•ˆë‚´ -->
    <div class="text-muted mt-3">
      â€» ì‹œê°„ì€ ë§¤ì›” í•™êµ ê³µì§€ ê¸°ì¤€ìœ¼ë¡œ ìˆ˜ì§‘ë©ë‹ˆë‹¤. í˜¼ì¡ë„ ì •ë³´ëŠ” í–¥í›„ ì—…ë°ì´íŠ¸ë  ì˜ˆì •ì…ë‹ˆë‹¤.
    </div>
  </div>

 <script>
  const now = new Date();
  document.getElementById("current-time").innerText = now.toLocaleTimeString("ko-KR");

  const nowMinutes = now.getHours() * 60 + now.getMinutes();
  const tbody = document.getElementById("shuttle-table-body");

  fetch("/static/data/shuttle_data.json")
    .then(response => response.json())
    .then(data => {
      Object.entries(data).forEach(([direction, shuttleList]) => {
        shuttleList.forEach((bus) => {
          const time = bus.time || bus.remark;  // ë‘˜ ì¤‘ í•˜ë‚˜ê°€ ì‹œê°„
          if (!time) return; // ì‹œê°„ ì •ë³´ ì—†ìœ¼ë©´ ê±´ë„ˆëœ€

          const [hour, min] = time.split(":").map(Number);
          const totalMinutes = hour * 60 + min;
          const diff = totalMinutes - nowMinutes;

          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${direction}</td>
            <td>${time}</td>
            <td>${diff >= 0 ? `${diff}ë¶„ í›„` : "ì¶œë°œ ì™„ë£Œ"}</td>
            <td>${bus.remark && bus.time ? bus.remark : ""}</td>
          `;
          tbody.appendChild(tr);
        });
      });
    })
    .catch(error => {
      console.error("ì…”í‹€ ë°ì´í„° ë¡œë”© ì‹¤íŒ¨:", error);
      tbody.innerHTML = '<tr><td colspan="4" class="text-center text-danger">ì…”í‹€ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
    });
</script>


  <script src="/static/js/bootstrap.bundle.min.js"></script>
</body>
</html>
